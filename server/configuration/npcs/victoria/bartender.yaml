bartender:
  tree:
    start:
      dialog: 
        - line: |
            <npc> says "Take a seat, or don't... I don't car..."
          quest_check:
          - id: rat_king
            state: not_started
        - line: |
            <npc> says "Life is meaningless and im going to kill myself"
          quest_check:
          - id: rat_king
            state: not_started
        - line: |
            <npc> says "Is it done?"
          quest_check:
          - id: rat_king
            state: in_progress
        - line: |
            <npc> says "Is it done?"
          quest_check:
          - id: rat_king
            state: completed
        - line: |
            <npc> says "Thanks for the help with the rat problem, appreciate it!"
          quest_check:
            - id: rat_king
              state: turned_in
      options:
        - line: |
            inquire about their wellbeing
          goto: not_started
          quest_check:
            - id: rat_king
              state: not_started
        - line: |
            shake your head
          goto: in_progress
          quest_check:
          - id: rat_king
            state: in_progress
        - line: |
            smile and tell them of how you slayed the rat king
          goto: completed
          quest_check:
            - id: rat_king
              state: completed
          quest_turn_in:
            id: rat_king
            reward_exp: 50
            reward:
              - beer_stein
        - line: |
            ask about equipment
          goto: ask_about_equipment
          quest_check:
            - id: first_equipment_set
              state: not_started
        - line: |
            Tell them about the wasted with the potion
          goto: first_equipment_set_completed
          quest_check:
            - id: first_equipment_set
              state: completed
          
              

    ask_about_equipment:
      dialog: 
        - line: |
            "Oh I have some adventuring equipment around here somewhere" they say...
            "I can give you some, if you can go talk to the drunkards and tell them to calm down a bit"
            Just as the bartender finishes their sentence, you hear a loud "WOOO!!!" from behind you
      options:
        - line: |
            say "Ok"
          goto: ask_about_equipment_accept
          quest_check:
            - id: first_equipment_set
              state: not_started
          quest_start:
            id: first_equipment_set

    ask_about_equipment_accept:
      dialog: 
        - line: |
            "Great!" they say enthusiastically

    first_equipment_set_completed:
      dialog: 
        - line: |
            "Oh god..." they say while cleaning a fork, "Alright what gear do you want? I got all sorts of trash left behind by adventurers"
      options:
        - line: |
            pick something for survivability
          goto: first_equipment_set_turn_in
          quest_turn_in:
            id: first_equipment_set
            reward_exp: 10
            reward:
              - grit body 1
              - grit head 1
        - line: |
            pick something for avoidability
          goto: first_equipment_set_turn_in
          quest_turn_in:
            id: first_equipment_set
            reward_exp: 10
            reward:
              - flow body 1
              - flow head 1
        - line: |
            pick something smart
          goto: first_equipment_set_turn_in
          quest_turn_in:
            id: first_equipment_set
            reward_exp: 10
            reward:
              - mind body 1
              - mind head 1  
        - line: |
            pick something the developer has a preference for
          goto: first_equipment_set_turn_in
          quest_turn_in:
            id: first_equipment_set
            reward_exp: 11
            reward:
              - soul body 1
              - soul head 1

    first_equipment_set_turn_in:
      dialog: 
        - line: |
            They duck under the counter and pull out a big box full of clothes and weapons. "here you go"

        

    in_progress:
      dialog: 
      - line: |
          "Oh..." They utter
    not_started:
      dialog:
        - line: |
            <npc> says "Been better, these dang rats keep gnawing at my boots.
            There is a big rat problem in this tavern, if you find the key
            to the cellar, would you mind helping me out?"

            They point behind them at a beer keg "I'll pay you for your effors"
      options:
        - line: |
            accept
          goto: accepted
          quest_check:
            - id: rat_king
              state: not_started
          quest_start:
            id: rat_king
        - line: |
            decline
          goto: declined
    accepted:
      dialog: 
        - line: |
            <npc> says "Thank you, I lost my key, but it should be here somewhere"
    declined:
      dialog:
        - line: | 
            <npc> says "Bummer..."
    completed:
      dialog:
        - line: |
            <npc> says "Good job! here take this"

    start_shopping:
      append_to: start
      options:
        - line: |
            ask about wares
          goto: shopping
      
    shopping:
      dialog: 
          - line: |
              <npc> says "I got plenty to sell!"
          - line: |
              <npc> says "What can I get ya?"
          - line: |
              <npc> says "Need anything?"
      options:
        - line: |
            purchase 1 Red Potion for 60 Scrap
          goto: shopping
          trade:
            give_to_player:
              - item: red potion
                amount: 1
            give_to_npc: 
              - item: currency_0
                amount: 60
        - line: |
            purchase 1 Blue Potion for 60 Scrap
          goto: shopping
          trade:
            give_to_player:
              - item: blue potion
                amount: 1
            give_to_npc: 
              - item: currency_0
                amount: 60
      
        